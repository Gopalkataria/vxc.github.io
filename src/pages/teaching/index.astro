---
import { courseTypes, courseData, getCourseType } from "@/lib/teaching";
import { GLOBAL } from "../../lib/variables";
import Layout from "../../layouts/Layout.astro";
import Section from "../../components/common/Section.astro";
---

<Layout>
    <Fragment slot="head">
        <title>Teaching • Courses by Year</title>
        <meta
            name="description"
            content="A chronological list of teaching experience including workshops and university courses."
        />
        <meta property="og:title" content="Teaching • Courses by Year" />
        <meta
            property="og:description"
            content="A chronological list of teaching experience including workshops and university courses."
        />
        <meta property="og:image" content="/default-og.png" />
        <meta property="og:url" content="/teaching" />
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content="Teaching • Courses by Year" />
        <meta
            name="twitter:description"
            content="A chronological list of teaching experience including workshops and university courses."
        />
        <meta name="twitter:image" content="/default-og.png" />
        <meta http-equiv="content-language" content="en" />
        <meta name="language" content="English" />
        <link rel="canonical" href="/teaching" />
    </Fragment>

    <Section class="my-8">
        <div class="pt-8 pb-4">
            <h1 class="font-display text-3xl sm:text-4xl leading-loose">
                Teaching
            </h1>
            <p class="text-muted-foreground text-lg">
                Courses, workshops, and seminars organized by year.
            </p>
        </div>

        {
            courseData.map((yearBlock) => (
                <div class="mb-12" id={yearBlock.year}>
                    <h2 class="text-2xl font-semibold mb-4 border-b pb-2">
                        {yearBlock.year}
                    </h2>

                    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
                        {yearBlock.courses.map((course) => {
                            const type =
                                course.type || getCourseType(course.title);
                            const courseStyle =
                                courseTypes[type] || courseTypes.other;
                            const Icon = courseStyle.icon;

                            return (
                                <div
                                    class="rounded-2xl shadow p-4 border hover:shadow-md transition"
                                    key={course.title}
                                >
                                    <div
                                        class={`inline-flex items-center gap-2 px-2 py-1 rounded-full text-sm font-medium ${courseStyle.color}`}
                                    >
                                        <Icon class="w-4 h-4" />
                                        {type.charAt(0).toUpperCase() +
                                            type.slice(1)}
                                    </div>
                                    <h3 class="text-lg font-semibold mt-2">
                                        {course.title}
                                    </h3>
                                    <p class="text-sm text-muted-foreground">
                                        {course.season} • {course.institution}
                                    </p>
                                    {course.description && (
                                        <p class="mt-2 text-sm text-muted-foreground italic">
                                            {course.description}
                                        </p>
                                    )}
                                </div>
                            );
                        })}
                    </div>
                </div>
            ))
        }
    </Section>
</Layout>
